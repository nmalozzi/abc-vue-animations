<template>
  <div class="output-meter">
    <div class="output-meter-ticks">
      <div v-for="tick in ticks" :key="tick" class="tick">{{ tick }}</div>
    </div>
    <svg class="meter" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 104.46 723" xml:space="preserve"><g fill="#ccc"><path d="M95.88 78.49h3v566h-3zM8.47 78.49h-3v566h3v-566z"/></g><path d="M17.86 648.16c-3.31-1.14-9.44-5.72-9.44-11.24V88.18c-.84-4.48 6.83-7.93 6.83-7.93.4.24 0 0 0 0L27.8 655.6l-9.94-7.44z" opacity=".1" fill="#b3b3b3"/><path d="M97.38 636.91c0 24.66-90.41 25.34-90.41 0" fill="none" stroke="#a09f9f" stroke-width="3" stroke-miterlimit="10"/><path d="M55.84 79.85c0-8.6 41.1-8.34 40.11 0v180.53H55.84V79.85z" fill="#a6cc75"/><path d="M95.95 447.93v187.49c0 7.84-40.11 21.34-40.11 13.93V447.93h40.11z" fill="#f75c5c"/><path d="M95.95 260.38v187.55H55.84V260.38h40.11z" fill="#f9f55a"/><path d="M58.33 578.9V107.94a7 7 0 0 0-5.07-6.72v512.74c0 1.11-.9 2.01-2 2.01s-2-.9-2-2.01V101.25a7 7 0 0 0-4.93 6.69V578.9h-4.52v9.99h4.52v20.8a7 7 0 1 0 14 0v-20.8h4.4v-9.99h-4.4z" fill="#b3b3b3"/><path d="M51.26 615.98a2 2 0 0 0 2-2.01V101.22a6.82 6.82 0 0 0-4 .03v512.71c0 1.11.9 2.02 2 2.02z" fill="#e5e5e5"/><path d="M65.74 586.87H36.78a.83.83 0 0 0-.8 1l1.58 7.03c.08.37.41.64.8.64h1.43v16.74c0 1.63.3 3.25.89 4.77l3.97 10.23a2.13 2.13 0 0 0 2 1.37h9.49c.91 0 1.71-.57 2.03-1.42l3.75-10.29c.53-1.45.8-2.99.8-4.54v-16.87h1.21c.37 0 .7-.25.79-.61l1.8-7.03a.8.8 0 0 0-.78-1.02z" fill="#999"/><path d="M93.02 191.49a.25.25 0 0 0-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25s-.11-.25-.25-.25H58.67v-10.68h6.17a1 1 0 0 0 1-1.01 1 1 0 0 0-1-1.01h-6.17v-14.39h34.1c.14 0 .25-.11.25-.25s-.11-.25-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25s-.11-.25-.25-.25H58.67v-12.08h6.17c.55 0 1-.45 1-1.01s-.45-1.01-1-1.01h-7.17a1 1 0 0 0-1 1.01v483.86l.02.09-.02.09a1 1 0 0 0 1 1.01h7.17a1 1 0 0 0 1-1.01 1 1 0 0 0-1-1.01h-6.17v-37.71h6.17a1 1 0 0 0 1-1.01 1 1 0 0 0-1-1.01h-6.17v-12.31h34.1c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25s-.11-.25-.25-.25H58.67v-11.87h6.17a1 1 0 0 0 1-1.01 1 1 0 0 0-1-1.01h-6.17v-13.36h34.1c.14 0 .25-.11.25-.25s-.11-.25-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25H58.67v-12.37h6.17a1 1 0 0 0 1-1.01 1 1 0 0 0-1-1.01h-6.17v-12.7h34.1c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25H58.67v-11.48h6.17a1 1 0 0 0 1-1.01 1 1 0 0 0-1-1.01h-6.17v-12.45h34.1c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25H58.67v-11.73h6.17a1 1 0 0 0 1-1.01 1 1 0 0 0-1-1.01h-6.17v-13.16h34.1c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25H58.67v-12.94h6.17c.55 0 1-.45 1-1.01s-.45-1.01-1-1.01h-6.17V353.4h34.1c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25H58.67V328h6.17c.55 0 1-.45 1-1.01s-.45-1.01-1-1.01h-6.17v-13.19h34.1c.14 0 .25-.11.25-.25s-.11-.25-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25s-.11-.25-.25-.25H58.67v-10.99h6.17c.55 0 1-.45 1-1.01s-.45-1.01-1-1.01h-6.17v-12.94h34.1c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25h-34.1V260.3h33.36c.14 0 .25-.11.25-.25a.25.25 0 0 0-.25-.25H58.67V247h6.17a1 1 0 0 0 1-1.01 1 1 0 0 0-1-1.01h-6.17v-12.44h34.1c.14 0 .25-.11.25-.25s-.11-.25-.25-.25h-34.1v-12.52h33.36c.14 0 .25-.11.25-.25s-.11-.25-.25-.25H58.67v-11.74h6.17c.55 0 1-.45 1-1.01s-.45-1.01-1-1.01h-6.17v-13.5h34.1c.14-.02.25-.13.25-.27z" fill="#666"/><g fill="#f2f2f2"><path d="M50.81 67.44c27.68 0 42.25 12.35 47.48 18.07 1.03 1.13.14 2.83-1.47 2.83h-19c-.57 0-1.12-.23-1.47-.64-1.48-1.7-7.08-6.22-24.94-6.22-16.47 0-21.48 4.37-22.94 6.15-.36.44-.92.71-1.53.71H7.53c-1.54 0-2.44-1.57-1.56-2.72C10.35 79.94 23 67.44 50.81 67.44zM53.65 655.56c-27.68 0-42.25-12.35-47.48-18.07-1.03-1.13-.14-2.83 1.47-2.83h19c.57 0 1.12.23 1.47.64 1.48 1.7 7.08 6.22 24.94 6.22 16.47 0 21.48-4.37 22.94-6.15.36-.44.92-.71 1.53-.71h19.4c1.54 0 2.44 1.57 1.56 2.72-4.37 5.68-17.02 18.18-44.83 18.18z"/></g><g fill="gray"><path d="M9.17 11.72c21.1-15.53 62.84-15.72 85.64 0a7.4 7.4 0 0 1 3.35 6.07V82.3c-17.64-19.57-73.21-20.22-92.11 0V17.62a7.37 7.37 0 0 1 3.12-5.9zM95.29 711.29c-21.09 15.52-62.84 15.72-85.64 0a7.4 7.4 0 0 1-3.35-6.07V640.7c17.64 19.57 73.21 20.22 92.11 0v64.68a7.4 7.4 0 0 1-3.12 5.91z"/></g><g fill="#757575"><path d="M99.86 86.8a4.5 4.5 0 0 1-3.76-2.02c-.1-.14-2.76-3.9-9.4-7.62-6.31-3.53-17.57-7.74-35.44-7.74-31.15 0-43.12 14.6-43.24 14.74a4.5 4.5 0 0 1-7.04-5.6c.59-.74 14.84-18.14 50.28-18.14 39.33 0 51.85 18.64 52.37 19.43a4.5 4.5 0 0 1-3.77 6.95zM51.99 55.31a2.5 2.5 0 0 1-2.5-2.5V8.83a2.5 2.5 0 0 1 5 0v43.98a2.5 2.5 0 0 1-2.5 2.5zM64.61 56.35a2.5 2.5 0 0 1-2.5-2.5V9.87a2.5 2.5 0 0 1 5 0v43.98a2.5 2.5 0 0 1-2.5 2.5zM77.63 59.44a2.5 2.5 0 0 1-2.5-2.5V12.96a2.5 2.5 0 0 1 5 0v43.98a2.5 2.5 0 0 1-2.5 2.5zM90.66 64.8a2.5 2.5 0 0 1-2.5-2.5V18.31a2.5 2.5 0 0 1 5 0V62.3a2.5 2.5 0 0 1-2.5 2.5zM39.67 56.35a2.5 2.5 0 0 1-2.5-2.5V9.87a2.5 2.5 0 0 1 5 0v43.98a2.5 2.5 0 0 1-2.5 2.5zM26.65 59.44a2.5 2.5 0 0 1-2.5-2.5V12.96a2.5 2.5 0 0 1 5 0v43.98a2.5 2.5 0 0 1-2.5 2.5zM13.63 64.8a2.5 2.5 0 0 1-2.5-2.5V18.31a2.5 2.5 0 0 1 5 0V62.3a2.5 2.5 0 0 1-2.5 2.5zM102.76 638.12a4.49 4.49 0 0 0-6.32.72c-.12.15-12.1 14.74-43.24 14.74-17.87 0-29.14-4.21-35.44-7.74-6.64-3.72-9.29-7.47-9.4-7.62a4.5 4.5 0 0 0-7.53 4.93c.51.79 13.04 19.43 52.37 19.43 35.44 0 49.69-17.4 50.28-18.14a4.49 4.49 0 0 0-.72-6.32zM52.47 667.69a2.5 2.5 0 0 0-2.5 2.5v43.98a2.5 2.5 0 0 0 5 0v-43.98a2.5 2.5 0 0 0-2.5-2.5zM39.85 666.65a2.5 2.5 0 0 0-2.5 2.5v43.98a2.5 2.5 0 0 0 5 0v-43.98a2.5 2.5 0 0 0-2.5-2.5zM26.83 663.56a2.5 2.5 0 0 0-2.5 2.5v43.98a2.5 2.5 0 0 0 5 0v-43.98a2.5 2.5 0 0 0-2.5-2.5zM13.8 658.21a2.5 2.5 0 0 0-2.5 2.5v43.98a2.5 2.5 0 0 0 5 0v-43.98a2.5 2.5 0 0 0-2.5-2.5zM64.79 666.65a2.5 2.5 0 0 0-2.5 2.5v43.98a2.5 2.5 0 0 0 5 0v-43.98a2.5 2.5 0 0 0-2.5-2.5zM77.81 663.56a2.5 2.5 0 0 0-2.5 2.5v43.98a2.5 2.5 0 0 0 5 0v-43.98a2.5 2.5 0 0 0-2.5-2.5zM90.83 658.21a2.5 2.5 0 0 0-2.5 2.5v43.98a2.5 2.5 0 0 0 5 0v-43.98a2.5 2.5 0 0 0-2.5-2.5z"/></g></svg>
    <div
        :style="{height: waterHeight}"
        class="output-meter-water"
    >
      <div class="svg-wrap">
        <svg class="wave" viewBox="0 0 500 500" preserveAspectRatio="xMinYMin meet">
          <path d="M0,100 C150,200 350,0 500,100 L500,00 L0,0 Z" style="stroke: none; fill:#0197bb;"></path>
        </svg>
        <svg class="bubbles" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55.69 23.39" xml:space="preserve"><circle cx="10.72" cy="12.67" r="10.72" fill="#aacce0"/><path d="M4.29 13.36c-.85 0-1.55-.69-1.55-1.55A6.93 6.93 0 0 1 9.66 4.9a1.55 1.55 0 0 1 0 3.1 3.84 3.84 0 0 0-3.83 3.83c.01.84-.69 1.53-1.54 1.53z" fill="#fff"/><circle cx="15.34" cy="8.22" r="1.77" fill="#fff"/><circle cx="37.51" cy="16.55" r="5.89" fill="#aacce0"/><circle cx="48.25" cy="7.44" r="7.44" fill="#aacce0"/><path d="M46.7 3.52c0-.72.58-1.3 1.3-1.3a5.85 5.85 0 0 1 5.84 5.84 1.3 1.3 0 1 1-2.6 0 3.23 3.23 0 0 0-3.23-3.23c-.72 0-1.31-.59-1.31-1.31z" fill="#fff"/><circle cx="28.08" cy="5.31" r="5.01" fill="#aacce0"/><circle cx="26.56" cy="3.96" r="1.7" fill="#fff"/></svg>

      </div>
    </div>
  </div>

</template>

<script>
export default {
  props: {
    output: {
      required: true,
      type: Number
    },
    meterMax: {
      required: true,
      type: Number
    },
    meterMin: {
      default: 1,
      type: Number
    },
    cardinality: {
      default: 13,
      type: Number
    },
  },
  computed: {
    ticks: function () {
      let arr = [];
      const step = (this.meterMax - this.meterMin) / (this.cardinality - 1);
      for (var i = 0; i < this.cardinality; i++) {
        arr.push(Number((this.meterMin + (step * i)).toFixed(1)));
      }
      return arr;
    },
    waterHeight: function () {
      let height = ((554 / (this.cardinality - 1)) * this.output) + 40;
      return height + 'px';
    }
  }
}
</script>

<style scoped>
.output-meter {
  position: relative;
}
.output-meter-ticks {
  position: absolute;
  top: 112px;
  right: -6px;
  display: flex;
  flex-direction: column-reverse;
  justify-content: space-between;
  height: 478px;
  font-size: 14px;
  line-height: 1;
  width: 40px;
  z-index: 100;
}

svg.meter {
  position: relative;
  z-index: 10;
}

.output-meter-water {
  position: absolute;
  bottom: 76px;
  left: 8px;
  background: #01A0C6;
  width: calc(100% - 14px);
  z-index: 1;
}

.svg-wrap {
  position: relative;
}

.svg-wrap .wave {
  position: absolute;
  top: 0;
  left: 0;
  height: 80px;
  width: 40px;
}

.svg-wrap .bubbles {
  position: absolute;
  top: -2px;
  left: 2px;
  width: 20px;
}

</style>